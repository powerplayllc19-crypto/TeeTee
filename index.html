<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Athena - The most engaging learning app that grows with your child from ages 2-17">
    <meta name="theme-color" content="#7C3AED">
    <title>Athena - Learning Adventure</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkF0aGVuYSIsCiAgInNob3J0X25hbWUiOiAiQXRoZW5hIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJ0aGVtZV9jb2xvciI6ICIjN0MzQUVEIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxOTInIGhlaWdodD0nMTkyJyB2aWV3Qm94PScwIDAgMTkyIDE5Mic+JTNDZGVmcz4lM0NsaW5lYXJHcmFkaWVudCBpZD0nYScgeDE9JzAlJyB5MT0nMCUnIHgyPScxMDAlJyB5Mj0nMTAwJyUzRSUzQ3N0b3Agb2Zmc2V0PScwJScgc3R5bGU9J3N0b3AtY29sb3I6I0ZCNkI4QjtzdG9wLW9wYWNpdHk6MTUnIC8lM0Ulc3RvcCBvZmZzZXQ9JzEwMCUnIHN0eWxlPSdzdG9wLWNvbG9yOiM5QzMzQUQ7c3RvcC1vcGFjaXR5OjEnIC8lM0Ulc3RvcGxpbmVhckdyYWRpZW50JTNFJTNDZGVmcz4lM0NmaWx0ZXIgaWQ9J2InIHg9JzAnIHk9JzAnIHdpZHRoPScxJyBoZWlnaHQ9JzEnJTNFJTNDZmVHYXVzc2lhbkJsdXIgaW49JzAuNScgc3RkRGV2aWF0aW9uPSczJyAvJTNFJTNDL2ZpbHRlciUzRSUzQy9kZWZzJTNFJTNDcmVjdCB3aWR0aD0nMTkyJyBoZWlnaHQ9JzE5MicgZmlsbD0ndXJsKCNhKScgZmlsdGVyPSd1cmwoI2IpJy8lM0Ulc3RleHQgeD0nNTAlJyB5PSc1MCUnIGZvbnQtZmFtaWx5PSdGcmVkb2thJyBmb250LXNpemU9JzgwJyBmaWxsPSd3aGl0ZScgdGV4dC1hbmNob3I9J21pZGRsZScgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZmlsdGVyPSdkcm9wLXNoYWRvdygwIDQgNnByb2dyYWQpJyUzRSUzQy90ZXh0JTNFJTNDL3N2Zz4iLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9LAogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbCwlM0NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nNTEyJyBoZWlnaHQ9JzUxMicgdmlld0JveD0nMCAwIDUxMiA1MTInJTNFJTNDZGVmcyUzRSUzQ2xpbmVhckdyYWRpZW50IGlkPSdhJyB4MT0nMCUnIHkxPScwJScgeDI9JzEwMCUnIHkyPScxMDAlJyUzRSUzQ3N0b3Agb2Zmc2V0PScwJScgc3R5bGU9J3N0b3AtY29sb3I6I0ZCNkI4QjtzdG9wLW9wYWNpdHk6MTUnIC8lM0Ulc3RvcCBvZmZzZXQ9JzEwMCUnIHN0eWxlPSdzdG9wLWNvbG9yOiM5QzMzQUQ7c3RvcC1vcGFjaXR5OjEnIC8lM0Ulc3RvcGxpbmVhckdyYWRpZW50JTNFJTNDL2RlZnMlM0Ulc3RyZWN0IHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyBmaWxsPSd1cmwoI2EpJy8lM0UjdGV4dCB4PSc1MCUnIHk9JzUwJScgZm9udC1mYW1pbHk9J0ZyZWRva2EnIGZvbnQtc2l6ZT0nMjAwJyBmaWxsPSd3aGl0ZScgdGV4dC1hbmNob3I9J21pZGRsZScgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZmlsdGVyPSdkcm9wLXNoYWRvdygwIDggMTJweCByZ2JhKDAsMCwwLDAuMykpJyUzRSUzQy90ZXh0JTNFJTNDL3N2Zz4iLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
    
    <style>
        * {
            font-family: 'Fredoka', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            overflow-x: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Native App Animations */
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.05); }
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(1deg); }
            66% { transform: translateY(5px) rotate(-1deg); }
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1) rotate(180deg); }
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            10%, 30% { transform: scale(1.1); }
            20% { transform: scale(0.95); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(124, 58, 237, 0.5); }
            50% { box-shadow: 0 0 20px rgba(124, 58, 237, 0.8), 0 0 30px rgba(124, 58, 237, 0.6); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        @keyframes flip {
            from { transform: rotateY(0); }
            to { transform: rotateY(360deg); }
        }

        @keyframes morph {
            0%, 100% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
            50% { border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
        }

        .native-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .native-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .game-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 25px;
            padding: 20px;
            color: white;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s;
            opacity: 0;
        }

        .game-card:hover::before {
            animation: shine 0.6s ease-in-out;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); opacity: 0; }
        }

        .game-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.2);
        }

        .btn-native {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-native::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-native:active::after {
            width: 300px;
            height: 300px;
        }

        .btn-native:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .floating-nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 10px 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: flex;
            gap: 15px;
            animation: slideUp 0.5s ease-out;
        }

        .nav-item {
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .nav-item:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .particle {
            position: fixed;
            pointer-events: none;
            opacity: 0;
            z-index: 9999;
        }

        .sparkle {
            width: 10px;
            height: 10px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border-radius: 50%;
            animation: sparkle 1s ease-out forwards;
        }

        .star {
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            animation: sparkle 1.5s ease-out forwards;
        }

        .confetti {
            width: 10px;
            height: 20px;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #FFA07A);
            animation: float 2s ease-out forwards;
        }

        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
            z-index: 10000;
            animation: slideIn 0.5s ease-out;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease;
        }

        .streak-fire {
            animation: heartbeat 1s ease-in-out infinite;
        }

        .level-badge {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .mini-game {
            aspect-ratio: 1;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }

        .mini-game:hover {
            transform: scale(1.05) rotate(2deg);
        }

        .mini-game::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #FFA07A, #FF6B6B);
            border-radius: 20px;
            z-index: -1;
            animation: rainbow 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .mini-game:hover::after {
            opacity: 1;
        }

        /* Age-specific themes */
        .theme-seedling {
            background: linear-gradient(135deg, #FFE5B4 0%, #FFCC99 50%, #FFB366 100%);
        }

        .theme-explorer {
            background: linear-gradient(135deg, #87CEEB 0%, #98D8C8 50%, #F7DC6F 100%);
        }

        .theme-master {
            background: linear-gradient(135deg, #9B59B6 0%, #3498DB 50%, #E74C3C 100%);
        }

        /* Loading animation */
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
        }

        /* Safe area for mobile */
        .safe-area {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }

        /* Tab bar */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 1000;
        }

        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-item.active {
            color: #667eea;
        }

        .tab-item:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        /* App drawer */
        .app-drawer {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            z-index: 2000;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        .app-drawer.open {
            left: 0;
        }

        .drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .drawer-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        /* Game specific animations */
        .memory-card {
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .memory-card.flipped {
            transform: rotateY(180deg);
        }

        .memory-card-front,
        .memory-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .memory-card-back {
            transform: rotateY(180deg);
        }

        .puzzle-piece {
            cursor: move;
            transition: all 0.3s;
        }

        .puzzle-piece:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        .puzzle-piece.dragging {
            opacity: 0.5;
            transform: scale(1.1);
        }

        .drop-zone {
            border: 2px dashed rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .drop-zone.drag-over {
            background: rgba(102, 126, 234, 0.1);
            border-color: #667eea;
        }

        /* Sound wave animation */
        .sound-wave {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .sound-bar {
            width: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
            animation: soundWave 0.5s ease-in-out infinite;
        }

        .sound-bar:nth-child(1) { height: 10px; animation-delay: 0s; }
        .sound-bar:nth-child(2) { height: 20px; animation-delay: 0.1s; }
        .sound-bar:nth-child(3) { height: 15px; animation-delay: 0.2s; }
        .sound-bar:nth-child(4) { height: 25px; animation-delay: 0.3s; }
        .sound-bar:nth-child(5) { height: 18px; animation-delay: 0.4s; }

        @keyframes soundWave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.5); }
        }

        /* Typing animation */
        .typing-text {
            overflow: hidden;
            border-right: 3px solid #667eea;
            white-space: nowrap;
            animation: typing 2s steps(40, end), blink 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink {
            from, to { border-color: transparent; }
            50% { border-color: #667eea; }
        }

        /* Glow effect */
        .glow-effect {
            animation: glow 2s ease-in-out infinite;
        }

        /* Morphing shape */
        .morphing-shape {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            animation: morph 8s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-pink-50">
    <!-- App Container -->
    <div id="app" class="min-h-screen safe-area">
        <!-- Header -->
        <header class="bg-white/80 backdrop-blur-lg shadow-lg sticky top-0 z-50 transition-all duration-300">
            <div class="container mx-auto px-4 py-3">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <button onclick="app.toggleDrawer()" class="p-2 rounded-lg hover:bg-gray-100 transition">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <div class="flex items-center gap-2">
                            <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center text-white font-bold">
                                A
                            </div>
                            <h1 class="text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                                Athena
                            </h1>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <!-- Streak Counter -->
                        <div class="flex items-center gap-2 bg-orange-100 px-3 py-2 rounded-full">
                            <i class="fas fa-fire text-orange-500 streak-fire"></i>
                            <span class="font-semibold text-orange-700" id="streak-count">0</span>
                        </div>
                        
                        <!-- Points -->
                        <div class="flex items-center gap-2 bg-yellow-100 px-3 py-2 rounded-full">
                            <i class="fas fa-star text-yellow-500"></i>
                            <span class="font-semibold text-yellow-700" id="points-count">0</span>
                        </div>
                        
                        <!-- Level Badge -->
                        <div class="level-badge">
                            <i class="fas fa-trophy"></i>
                            <span id="level-text">Level 1</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content" class="container mx-auto px-4 py-6 pb-24">
            <!-- Dynamic content will be rendered here -->
        </main>

        <!-- Tab Bar -->
        <nav class="tab-bar">
            <div class="tab-item active" onclick="app.switchTab('home')">
                <i class="fas fa-home text-xl"></i>
                <span class="text-xs mt-1">Home</span>
            </div>
            <div class="tab-item" onclick="app.switchTab('games')">
                <i class="fas fa-gamepad text-xl"></i>
                <span class="text-xs mt-1">Games</span>
            </div>
            <div class="tab-item" onclick="app.switchTab('progress')">
                <i class="fas fa-chart-line text-xl"></i>
                <span class="text-xs mt-1">Progress</span>
            </div>
            <div class="tab-item" onclick="app.switchTab('profile')">
                <i class="fas fa-user text-xl"></i>
                <span class="text-xs mt-1">Profile</span>
            </div>
        </nav>
    </div>

    <!-- App Drawer -->
    <div class="drawer-overlay" id="drawer-overlay" onclick="app.toggleDrawer()"></div>
    <div class="app-drawer" id="app-drawer">
        <div class="p-6">
            <h2 class="text-2xl font-bold mb-6">Menu</h2>
            
            <!-- User Profile Section -->
            <div class="flex items-center gap-4 mb-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl">
                <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-2xl font-bold">
                    <span id="user-avatar">üë¶</span>
                </div>
                <div>
                    <h3 class="font-semibold text-lg" id="user-name">Explorer</h3>
                    <p class="text-sm text-gray-600" id="user-age">Age Group: Seedling</p>
                </div>
            </div>

            <!-- Navigation Items -->
            <nav class="space-y-2">
                <button onclick="app.showAgeSelector()" class="w-full text-left p-3 rounded-lg hover:bg-gray-100 transition flex items-center gap-3">
                    <i class="fas fa-users text-purple-500"></i>
                    <span>Change Age Group</span>
                </button>
                <button onclick="app.showAchievements()" class="w-full text-left p-3 rounded-lg hover:bg-gray-100 transition flex items-center gap-3">
                    <i class="fas fa-trophy text-yellow-500"></i>
                    <span>Achievements</span>
                </button>
                <button onclick="app.showSettings()" class="w-full text-left p-3 rounded-lg hover:bg-gray-100 transition flex items-center gap-3">
                    <i class="fas fa-cog text-gray-500"></i>
                    <span>Settings</span>
                </button>
                <button onclick="app.showParents()" class="w-full text-left p-3 rounded-lg hover:bg-gray-100 transition flex items-center gap-3">
                    <i class="fas fa-shield-alt text-green-500"></i>
                    <span>Parents Area</span>
                </button>
            </nav>

            <!-- Daily Challenge -->
            <div class="mt-6 p-4 bg-gradient-to-r from-orange-400 to-pink-400 rounded-xl text-white">
                <h3 class="font-bold mb-2">Daily Challenge</h3>
                <p class="text-sm mb-3">Complete 3 games today!</p>
                <div class="flex items-center gap-2">
                    <div class="flex-1 bg-white/20 rounded-full h-2">
                        <div class="bg-white h-2 rounded-full" style="width: 33%"></div>
                    </div>
                    <span class="text-sm">1/3</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Sound Effects -->
    <audio id="sound-success" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZSA0PVqzn77BdGAg+ltryxnMpBSuBzvLZizcIGWi77eefTRAMUKfj8LZjHAY4ktfyy3ksBSR3x/DdkEAKFF606+uoVRQKRp/g8r5sIQUxh9Hz04IzBh5uwO/jmUgND1as5++wXRgIPpba8sZzKQUrgs7y2Ys3CBlou+3nn00QDFCn4/C2YxwGOJLX8st5LAUkd8fw3ZBACB1f" type="audio/wav">
    </audio>
    <audio id="sound-error" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAAD///////////////8=" type="audio/wav">
    </audio>
    <audio id="sound-click" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZSA0PVqzn77BdGAg+ltryxnMpBSuBzvLZizcIGWi77eefTRAMUKfj8LZjHAY4ktfyy3ksBSR3x/DdkEAKFF606+uoVRQKRp/g8r5sIQUxh9Hz04IzBh5uwO/jmUgND1as5++wXRgIPpba8sZzKQUrgs7y2Ys3CBlou+3nn00QDFCn4/C2YxwGOJLX8st5LAUkd8fw3ZBACB1f" type="audio/wav">
    </audio>
    <audio id="sound-levelup" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZSA0PVqzn77BdGAg+ltryxnMpBSuBzvLZizcIGWi77eefTRAMUKfj8LZjHAY4ktfyy3ksBSR3x/DdkEAKFF606+uoVRQKRp/g8r5sIQUxh9Hz04IzBh5uwO/jmUgND1as5++wXRgIPpba8sZzKQUrgs7y2Ys3CBlou+3nn00QDFCn4/C2YxwGOJLX8st5LAUkd8fw3ZBACB1f" type="audio/wav">
    </audio>

    <!-- Templates -->
    <template id="home-template">
        <div class="space-y-6">
            <!-- Welcome Banner -->
            <div class="native-card p-6 text-center">
                <h2 class="text-3xl font-bold mb-2 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                    Welcome back, <span id="welcome-name">Explorer</span>! üéâ
                </h2>
                <p class="text-gray-600">Ready for today's learning adventure?</p>
            </div>

            <!-- Daily Challenge Card -->
            <div class="native-card p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-bold">Daily Challenge üéØ</h3>
                    <span class="text-sm text-gray-500">2/3 Complete</span>
                </div>
                <div class="flex items-center gap-4">
                    <div class="flex-1">
                        <div class="bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-orange-400 to-pink-400 h-3 rounded-full" style="width: 66%"></div>
                        </div>
                    </div>
                    <button class="btn-native" onclick="app.showDailyChallenge()">
                        Continue
                    </button>
                </div>
            </div>

            <!-- Quick Start Games -->
            <div>
                <h3 class="text-xl font-bold mb-4">Quick Start üöÄ</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="mini-game bg-gradient-to-br from-blue-400 to-blue-600 text-white" onclick="app.startGame('memory')">
                        <i class="fas fa-brain text-4xl mb-2"></i>
                        <span class="text-sm font-semibold">Memory Match</span>
                    </div>
                    <div class="mini-game bg-gradient-to-br from-green-400 to-green-600 text-white" onclick="app.startGame('puzzle')">
                        <i class="fas fa-puzzle-piece text-4xl mb-2"></i>
                        <span class="text-sm font-semibold">Puzzle</span>
                    </div>
                    <div class="mini-game bg-gradient-to-br from-purple-400 to-purple-600 text-white" onclick="app.startGame('tracing')">
                        <i class="fas fa-pencil-alt text-4xl mb-2"></i>
                        <span class="text-sm font-semibold">Tracing</span>
                    </div>
                    <div class="mini-game bg-gradient-to-br from-red-400 to-red-600 text-white" onclick="app.startGame('math')">
                        <i class="fas fa-calculator text-4xl mb-2"></i>
                        <span class="text-sm font-semibold">Math</span>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">Recent Activity üìä</h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-check text-green-600"></i>
                            </div>
                            <div>
                                <p class="font-semibold">Memory Match</p>
                                <p class="text-sm text-gray-500">Completed 10 min ago</p>
                            </div>
                        </div>
                        <span class="text-green-600 font-semibold">+50 pts</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-star text-blue-600"></i>
                            </div>
                            <div>
                                <p class="font-semibold">Math Challenge</p>
                                <p class="text-sm text-gray-500">Completed 1 hour ago</p>
                            </div>
                        </div>
                        <span class="text-blue-600 font-semibold">+75 pts</span>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="games-template">
        <div class="space-y-6">
            <h2 class="text-2xl font-bold">All Games üéÆ</h2>
            
            <!-- Game Categories -->
            <div class="flex gap-2 overflow-x-auto pb-2">
                <button class="btn-native whitespace-nowrap">All</button>
                <button class="btn-native whitespace-nowrap bg-gray-200 text-gray-700">Math</button>
                <button class="btn-native whitespace-nowrap bg-gray-200 text-gray-700">Reading</button>
                <button class="btn-native whitespace-nowrap bg-gray-200 text-gray-700">Science</button>
                <button class="btn-native whitespace-nowrap bg-gray-200 text-gray-700">Logic</button>
            </div>

            <!-- Games Grid -->
            <div class="game-grid">
                <div class="game-card" onclick="app.startGame('memory')">
                    <i class="fas fa-brain text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Memory Match</h3>
                    <p class="text-sm opacity-90">Test your memory skills</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Brain Training</span>
                        <span class="text-xs">‚≠ê 4.8</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('puzzle')">
                    <i class="fas fa-puzzle-piece text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Jigsaw Puzzle</h3>
                    <p class="text-sm opacity-90">Solve colorful puzzles</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Logic</span>
                        <span class="text-xs">‚≠ê 4.7</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('tracing')">
                    <i class="fas fa-pencil-alt text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Letter Tracing</h3>
                    <p class="text-sm opacity-90">Learn to write letters</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Writing</span>
                        <span class="text-xs">‚≠ê 4.9</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('math')">
                    <i class="fas fa-calculator text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Math Adventure</h3>
                    <p class="text-sm opacity-90">Fun math challenges</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Mathematics</span>
                        <span class="text-xs">‚≠ê 4.6</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('science')">
                    <i class="fas fa-flask text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Science Lab</h3>
                    <p class="text-sm opacity-90">Amazing experiments</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Science</span>
                        <span class="text-xs">‚≠ê 4.8</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('music')">
                    <i class="fas fa-music text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Music Maker</h3>
                    <p class="text-sm opacity-90">Create beautiful music</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Arts</span>
                        <span class="text-xs">‚≠ê 4.7</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('spelling')">
                    <i class="fas fa-spell-check text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Spelling Bee</h3>
                    <p class="text-sm opacity-90">Master spelling skills</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Language</span>
                        <span class="text-xs">‚≠ê 4.5</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('coding')">
                    <i class="fas fa-code text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">Code Quest</h3>
                    <p class="text-sm opacity-90">Learn programming basics</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Technology</span>
                        <span class="text-xs">‚≠ê 4.9</span>
                    </div>
                </div>

                <div class="game-card" onclick="app.startGame('geography')">
                    <i class="fas fa-globe text-5xl mb-3"></i>
                    <h3 class="text-xl font-bold mb-2">World Explorer</h3>
                    <p class="text-sm opacity-90">Discover the world</p>
                    <div class="mt-3 flex items-center gap-2">
                        <span class="text-xs bg-white/20 px-2 py-1 rounded">Geography</span>
                        <span class="text-xs">‚≠ê 4.6</span>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="progress-template">
        <div class="space-y-6">
            <h2 class="text-2xl font-bold">Your Progress üìà</h2>

            <!-- Stats Overview -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="native-card p-4 text-center">
                    <div class="text-3xl font-bold text-purple-600" id="total-points">0</div>
                    <p class="text-sm text-gray-600">Total Points</p>
                </div>
                <div class="native-card p-4 text-center">
                    <div class="text-3xl font-bold text-orange-600" id="current-streak">0</div>
                    <p class="text-sm text-gray-600">Day Streak</p>
                </div>
                <div class="native-card p-4 text-center">
                    <div class="text-3xl font-bold text-green-600" id="games-played">0</div>
                    <p class="text-sm text-gray-600">Games Played</p>
                </div>
                <div class="native-card p-4 text-center">
                    <div class="text-3xl font-bold text-blue-600" id="achievements-count">0</div>
                    <p class="text-sm text-gray-600">Achievements</p>
                </div>
            </div>

            <!-- Weekly Progress Chart -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">This Week's Activity</h3>
                <div class="flex items-end justify-between h-40 mb-2">
                    <div class="flex-1 mx-1 bg-purple-200 rounded-t" style="height: 60%">
                        <div class="bg-purple-500 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">M</div>
                    </div>
                    <div class="flex-1 mx-1 bg-purple-200 rounded-t" style="height: 80%">
                        <div class="bg-purple-500 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">T</div>
                    </div>
                    <div class="flex-1 mx-1 bg-purple-200 rounded-t" style="height: 45%">
                        <div class="bg-purple-500 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">W</div>
                    </div>
                    <div class="flex-1 mx-1 bg-purple-200 rounded-t" style="height: 90%">
                        <div class="bg-purple-500 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">T</div>
                    </div>
                    <div class="flex-1 mx-1 bg-purple-200 rounded-t" style="height: 70%">
                        <div class="bg-purple-500 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">F</div>
                    </div>
                    <div class="flex-1 mx-1 bg-purple-200 rounded-t" style="height: 100%">
                        <div class="bg-orange-500 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">S</div>
                    </div>
                    <div class="flex-1 mx-1 bg-gray-200 rounded-t" style="height: 20%">
                        <div class="bg-gray-400 rounded-t h-full flex items-end justify-center text-white text-xs pb-1">S</div>
                    </div>
                </div>
                <div class="flex justify-between text-xs text-gray-500">
                    <span>Mon</span>
                    <span>Tue</span>
                    <span>Wed</span>
                    <span>Thu</span>
                    <span>Fri</span>
                    <span>Sat</span>
                    <span>Sun</span>
                </div>
            </div>

            <!-- Skills Progress -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">Skills Development</h3>
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium">Mathematics</span>
                            <span class="text-sm text-gray-600">75%</span>
                        </div>
                        <div class="bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-3 rounded-full" style="width: 75%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium">Reading</span>
                            <span class="text-sm text-gray-600">60%</span>
                        </div>
                        <div class="bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-green-400 to-green-600 h-3 rounded-full" style="width: 60%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium">Science</span>
                            <span class="text-sm text-gray-600">45%</span>
                        </div>
                        <div class="bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-purple-400 to-purple-600 h-3 rounded-full" style="width: 45%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium">Logic</span>
                            <span class="text-sm text-gray-600">85%</span>
                        </div>
                        <div class="bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-red-400 to-red-600 h-3 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Achievements -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">Recent Achievements üèÜ</h3>
                <div class="grid grid-cols-3 gap-3">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-2">
                            <i class="fas fa-fire text-2xl text-yellow-600"></i>
                        </div>
                        <p class="text-xs font-medium">Week Warrior</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2">
                            <i class="fas fa-brain text-2xl text-blue-600"></i>
                        </div>
                        <p class="text-xs font-medium">Memory Master</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2">
                            <i class="fas fa-star text-2xl text-green-600"></i>
                        </div>
                        <p class="text-xs font-medium">Star Student</p>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="profile-template">
        <div class="space-y-6">
            <!-- Profile Header -->
            <div class="native-card p-6 text-center">
                <div class="w-24 h-24 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-4xl font-bold mx-auto mb-4">
                    <span id="profile-avatar">üë¶</span>
                </div>
                <h2 class="text-2xl font-bold mb-2" id="profile-name">Explorer</h2>
                <p class="text-gray-600 mb-4">Level <span id="profile-level">1</span> Learner</p>
                
                <div class="flex justify-center gap-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="profile-points">0</div>
                        <p class="text-sm text-gray-600">Points</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600" id="profile-streak">0</div>
                        <p class="text-sm text-gray-600">Streak</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="profile-rank">Beginner</div>
                        <p class="text-sm text-gray-600">Rank</p>
                    </div>
                </div>
            </div>

            <!-- Customization Options -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">Customize Your Avatar üé®</h3>
                <div class="grid grid-cols-4 gap-3">
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('üë¶')">üë¶</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('üëß')">üëß</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('üßí')">üßí</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('üë∂')">üë∂</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('ü¶∏')">ü¶∏</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('üë©‚ÄçüöÄ')">üë©‚ÄçüöÄ</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('üßô')">üßô</button>
                    <button class="p-4 bg-gray-100 rounded-xl hover:bg-gray-200 transition" onclick="app.changeAvatar('ü§ñ')">ü§ñ</button>
                </div>
            </div>

            <!-- Learning Preferences -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">Learning Preferences üìö</h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span>Sound Effects</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                        </label>
                    </div>
                    <div class="flex items-center justify-between">
                        <span>Background Music</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                        </label>
                    </div>
                    <div class="flex items-center justify-between">
                        <span>Vibrations</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Parental Controls -->
            <div class="native-card p-6">
                <h3 class="text-xl font-bold mb-4">Parental Controls üë®‚Äçüë©‚Äçüëß‚Äçüë¶</h3>
                <div class="space-y-3">
                    <button class="w-full btn-native text-left flex items-center justify-between">
                        <span>Screen Time Limits</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="w-full btn-native text-left flex items-center justify-between">
                        <span>Progress Reports</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="w-full btn-native text-left flex items-center justify-between">
                        <span>Content Filters</span>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </template>

    <!-- Memory Game Template -->
    <template id="memory-game-template">
        <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div class="bg-white rounded-3xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">Memory Match üß†</h2>
                    <button onclick="app.closeGame()" class="p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <!-- Game Stats -->
                <div class="flex justify-around mb-6">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="memory-moves">0</div>
                        <p class="text-sm text-gray-600">Moves</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="memory-matches">0</div>
                        <p class="text-sm text-gray-600">Matches</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="memory-time">00:00</div>
                        <p class="text-sm text-gray-600">Time</p>
                    </div>
                </div>

                <!-- Memory Grid -->
                <div id="memory-grid" class="grid grid-cols-4 gap-3 mb-6">
                    <!-- Cards will be generated here -->
                </div>

                <!-- Controls -->
                <div class="flex gap-3">
                    <button onclick="app.resetMemoryGame()" class="btn-native flex-1">
                        <i class="fas fa-redo mr-2"></i> New Game
                    </button>
                    <button onclick="app.showHint()" class="btn-native flex-1 bg-orange-500">
                        <i class="fas fa-lightbulb mr-2"></i> Hint
                    </button>
                </div>
            </div>
        </div>
    </template>

    <!-- Puzzle Game Template -->
    <template id="puzzle-game-template">
        <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div class="bg-white rounded-3xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">Jigsaw Puzzle üß©</h2>
                    <button onclick="app.closeGame()" class="p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <!-- Puzzle Container -->
                <div class="relative bg-gray-100 rounded-2xl p-4 mb-4" style="height: 400px;">
                    <div id="puzzle-container" class="relative w-full h-full">
                        <!-- Puzzle pieces will be generated here -->
                    </div>
                </div>

                <!-- Controls -->
                <div class="flex gap-3">
                    <button onclick="app.shufflePuzzle()" class="btn-native flex-1">
                        <i class="fas fa-random mr-2"></i> Shuffle
                    </button>
                    <button onclick="app.showPuzzlePreview()" class="btn-native flex-1 bg-blue-500">
                        <i class="fas fa-eye mr-2"></i> Preview
                    </button>
                    <button onclick="app.changePuzzleImage()" class="btn-native flex-1 bg-green-500">
                        <i class="fas fa-image mr-2"></i> Change Image
                    </button>
                </div>
            </div>
        </div>
    </template>

    <!-- Tracing Game Template -->
    <template id="tracing-game-template">
        <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div class="bg-white rounded-3xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">Letter Tracing ‚úèÔ∏è</h2>
                    <button onclick="app.closeGame()" class="p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <!-- Tracing Options -->
                <div class="flex gap-2 mb-4">
                    <button onclick="app.setTracingMode('letters')" class="btn-native bg-purple-500">Letters</button>
                    <button onclick="app.setTracingMode('numbers')" class="btn-native bg-blue-500">Numbers</button>
                    <button onclick="app.setTracingMode('shapes')" class="btn-native bg-green-500">Shapes</button>
                </div>

                <!-- Character Display -->
                <div class="text-center mb-4">
                    <div id="tracing-character" class="text-8xl font-bold text-gray-300">A</div>
                </div>

                <!-- Canvas -->
                <canvas id="tracing-canvas" class="w-full h-64 border-2 border-gray-300 rounded-2xl mb-4"></canvas>

                <!-- Controls -->
                <div class="flex gap-3">
                    <button onclick="app.clearTracing()" class="btn-native flex-1">
                        <i class="fas fa-eraser mr-2"></i> Clear
                    </button>
                    <button onclick="app.nextTracingCharacter()" class="btn-native flex-1 bg-green-500">
                        <i class="fas fa-arrow-right mr-2"></i> Next
                    </button>
                    <button onclick="app.checkTracing()" class="btn-native flex-1 bg-blue-500">
                        <i class="fas fa-check mr-2"></i> Check
                    </button>
                </div>
            </div>
        </div>
    </template>

    <!-- Math Game Template -->
    <template id="math-game-template">
        <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div class="bg-white rounded-3xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">Math Adventure üî¢</h2>
                    <button onclick="app.closeGame()" class="p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <!-- Score Display -->
                <div class="flex justify-between mb-6">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="math-score">0</div>
                        <p class="text-sm text-gray-600">Score</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="math-level">1</div>
                        <p class="text-sm text-gray-600">Level</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600" id="math-streak">0</div>
                        <p class="text-sm text-gray-600">Streak</p>
                    </div>
                </div>

                <!-- Math Problem -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-8 mb-6 text-center">
                    <div id="math-problem" class="text-4xl font-bold mb-6">5 + 3 = ?</div>
                    <div id="math-options" class="grid grid-cols-2 gap-3">
                        <!-- Options will be generated here -->
                    </div>
                </div>

                <!-- Feedback -->
                <div id="math-feedback" class="text-center text-lg font-semibold mb-4"></div>

                <!-- Controls -->
                <div class="flex gap-3">
                    <button onclick="app.skipMathProblem()" class="btn-native flex-1 bg-gray-500">
                        <i class="fas fa-forward mr-2"></i> Skip
                    </button>
                    <button onclick="app.showMathHint()" class="btn-native flex-1 bg-orange-500">
                        <i class="fas fa-lightbulb mr-2"></i> Hint
                    </button>
                </div>
            </div>
        </div>
    </template>

    <script>
        // Main App Object
        const app = {
            // State
            state: {
                currentView: 'home',
                currentTab: 'home',
                ageGroup: 'seedling',
                user: {
                    name: 'Explorer',
                    avatar: 'üë¶',
                    level: 1,
                    points: 0,
                    streak: 0,
                    totalPoints: 0,
                    gamesPlayed: 0,
                    achievements: []
                },
                gameData: {},
                dailyChallenge: {
                    completed: 0,
                    total: 3
                }
            },

            // Initialize app
            init() {
                this.loadState();
                this.render();
                this.setupEventListeners();
                this.startAnimations();
                this.checkDailyStreak();
            },

            // Load state from localStorage
            loadState() {
                const saved = localStorage.getItem('athena-state');
                if (saved) {
                    try {
                        const parsed = JSON.parse(saved);
                        this.state = { ...this.state, ...parsed };
                    } catch (e) {
                        console.log('No valid saved state');
                    }
                }
            },

            // Save state to localStorage
            saveState() {
                localStorage.setItem('athena-state', JSON.stringify(this.state));
            },

            // Render current view
            render() {
                const main = document.getElementById('main-content');
                const templateId = this.getViewTemplateId(this.state.currentTab);
                const template = document.getElementById(templateId);
                
                if (template) {
                    main.innerHTML = '';
                    main.appendChild(template.content.cloneNode(true));
                    this.postRender();
                }
            },

            getViewTemplateId(tab) {
                const templates = {
                    'home': 'home-template',
                    'games': 'games-template',
                    'progress': 'progress-template',
                    'profile': 'profile-template'
                };
                return templates[tab] || 'home-template';
            },

            postRender() {
                this.updateUI();
            },

            updateUI() {
                // Update header stats
                document.getElementById('streak-count').textContent = this.state.user.streak;
                document.getElementById('points-count').textContent = this.state.user.points;
                document.getElementById('level-text').textContent = `Level ${this.state.user.level}`;

                // Update welcome name
                const welcomeName = document.getElementById('welcome-name');
                if (welcomeName) {
                    welcomeName.textContent = this.state.user.name;
                }

                // Update profile elements
                const profileElements = {
                    'profile-avatar': this.state.user.avatar,
                    'profile-name': this.state.user.name,
                    'profile-level': this.state.user.level,
                    'profile-points': this.state.user.points,
                    'profile-streak': this.state.user.streak,
                    'profile-rank': this.getRank()
                };

                Object.entries(profileElements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    }
                });

                // Update progress stats
                const progressElements = {
                    'total-points': this.state.user.totalPoints,
                    'current-streak': this.state.user.streak,
                    'games-played': this.state.user.gamesPlayed,
                    'achievements-count': this.state.user.achievements.length
                };

                Object.entries(progressElements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    }
                });
            },

            getRank() {
                const points = this.state.user.totalPoints;
                if (points >= 10000) return 'Master';
                if (points >= 5000) return 'Expert';
                if (points >= 2000) return 'Advanced';
                if (points >= 500) return 'Intermediate';
                return 'Beginner';
            },

            // Tab switching
            switchTab(tab) {
                this.state.currentTab = tab;
                this.state.currentView = tab;
                
                // Update tab bar active state
                document.querySelectorAll('.tab-item').forEach(item => {
                    item.classList.remove('active');
                });
                event.currentTarget.classList.add('active');
                
                this.render();
                this.playSound('click');
            },

            // Drawer toggle
            toggleDrawer() {
                const drawer = document.getElementById('app-drawer');
                const overlay = document.getElementById('drawer-overlay');
                
                drawer.classList.toggle('open');
                overlay.classList.toggle('open');
                this.playSound('click');
            },

            // Game management
            startGame(gameType) {
                this.playSound('click');
                const templates = {
                    'memory': 'memory-game-template',
                    'puzzle': 'puzzle-game-template',
                    'tracing': 'tracing-game-template',
                    'math': 'math-game-template'
                };

                const templateId = templates[gameType];
                if (templateId) {
                    const template = document.getElementById(templateId);
                    const modal = document.createElement('div');
                    modal.innerHTML = template.innerHTML;
                    document.body.appendChild(modal);
                    
                    // Initialize game based on type
                    switch(gameType) {
                        case 'memory':
                            this.initMemoryGame();
                            break;
                        case 'puzzle':
                            this.initPuzzleGame();
                            break;
                        case 'tracing':
                            this.initTracingGame();
                            break;
                        case 'math':
                            this.initMathGame();
                            break;
                    }
                }
            },

            closeGame() {
                const modals = document.querySelectorAll('.fixed.inset-0');
                modals.forEach(modal => {
                    if (modal.querySelector('.bg-white')) {
                        modal.remove();
                    }
                });
                this.playSound('click');
            },

            // Memory Game
            initMemoryGame() {
                const emojis = ['üéà', 'üé®', 'üéØ', 'üé™', 'üé≠', 'üé∏', 'üé∫', 'üéª'];
                const cards = [...emojis, ...emojis];
                cards.sort(() => Math.random() - 0.5);

                const grid = document.getElementById('memory-grid');
                if (!grid) return;

                grid.innerHTML = cards.map((emoji, index) => `
                    <div class="memory-card h-20 bg-gradient-to-br from-purple-400 to-pink-400 rounded-xl cursor-pointer" 
                         data-emoji="${emoji}" 
                         data-index="${index}"
                         onclick="app.flipCard(${index})">
                        <div class="memory-card-front w-full h-full flex items-center justify-center">
                            <i class="fas fa-question text-white text-2xl"></i>
                        </div>
                        <div class="memory-card-back w-full h-full bg-white flex items-center justify-center text-3xl">
                            ${emoji}
                        </div>
                    </div>
                `).join('');

                this.gameData.memory = {
                    flipped: [],
                    matched: [],
                    moves: 0,
                    startTime: Date.now()
                };

                this.startMemoryTimer();
            },

            flipCard(index) {
                const card = document.querySelector(`[data-index="${index}"]`);
                if (!card || this.gameData.memory.flipped.includes(index) || this.gameData.memory.matched.includes(index)) {
                    return;
                }

                card.classList.add('flipped');
                this.gameData.memory.flipped.push(index);
                this.playSound('click');

                if (this.gameData.memory.flipped.length === 2) {
                    this.gameData.memory.moves++;
                    document.getElementById('memory-moves').textContent = this.gameData.memory.moves;
                    
                    setTimeout(() => this.checkMemoryMatch(), 1000);
                }
            },

            checkMemoryMatch() {
                const [first, second] = this.gameData.memory.flipped;
                const firstCard = document.querySelector(`[data-index="${first}"]`);
                const secondCard = document.querySelector(`[data-index="${second}"]`);

                if (firstCard.dataset.emoji === secondCard.dataset.emoji) {
                    this.gameData.memory.matched.push(first, second);
                    document.getElementById('memory-matches').textContent = this.gameData.memory.matched.length / 2;
                    this.playSound('success');
                    this.createParticles('star');
                    
                    if (this.gameData.memory.matched.length === 16) {
                        this.winMemoryGame();
                    }
                } else {
                    firstCard.classList.remove('flipped');
                    secondCard.classList.remove('flipped');
                    this.playSound('error');
                }

                this.gameData.memory.flipped = [];
            },

            startMemoryTimer() {
                const timer = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.gameData.memory.startTime) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    document.getElementById('memory-time').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            },

            winMemoryGame() {
                this.addPoints(100);
                this.showAchievement('Memory Master!', 'Completed memory game in ' + this.gameData.memory.moves + ' moves!');
                setTimeout(() => this.closeGame(), 2000);
            },

            resetMemoryGame() {
                this.initMemoryGame();
            },

            // Puzzle Game
            initPuzzleGame() {
                const container = document.getElementById('puzzle-container');
                if (!container) return;

                const pieces = 12;
                const pieceWidth = 100 / 4;
                const pieceHeight = 100 / 3;

                container.innerHTML = '';
                
                for (let i = 0; i < pieces; i++) {
                    const piece = document.createElement('div');
                    piece.className = 'puzzle-piece absolute border border-gray-300 bg-gradient-to-br from-blue-400 to-purple-400 rounded-lg flex items-center justify-center text-white font-bold text-xl';
                    piece.style.width = `${pieceWidth}%`;
                    piece.style.height = `${pieceHeight}%`;
                    piece.style.left = `${(i % 4) * pieceWidth}%`;
                    piece.style.top = `${Math.floor(i / 4) * pieceHeight}%`;
                    piece.textContent = i + 1;
                    piece.draggable = true;
                    piece.dataset.index = i;
                    
                    piece.addEventListener('dragstart', (e) => this.dragStart(e));
                    piece.addEventListener('dragover', (e) => this.dragOver(e));
                    piece.addEventListener('drop', (e) => this.drop(e));
                    piece.addEventListener('dragend', (e) => this.dragEnd(e));
                    
                    container.appendChild(piece);
                }
            },

            dragStart(e) {
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/html', e.target.innerHTML);
                e.target.classList.add('dragging');
            },

            dragOver(e) {
                if (e.preventDefault) {
                    e.preventDefault();
                }
                e.dataTransfer.dropEffect = 'move';
                return false;
            },

            drop(e) {
                if (e.stopPropagation) {
                    e.stopPropagation();
                }
                
                const dragging = document.querySelector('.dragging');
                const target = e.target.closest('.puzzle-piece');
                
                if (dragging && target && dragging !== target) {
                    const tempHTML = dragging.innerHTML;
                    const tempIndex = dragging.dataset.index;
                    dragging.innerHTML = target.innerHTML;
                    dragging.dataset.index = target.dataset.index;
                    target.innerHTML = tempHTML;
                    target.dataset.index = tempIndex;
                }
                
                return false;
            },

            dragEnd(e) {
                e.target.classList.remove('dragging');
            },

            shufflePuzzle() {
                const pieces = document.querySelectorAll('.puzzle-piece');
                const contents = Array.from(pieces).map(p => ({ html: p.innerHTML, index: p.dataset.index }));
                
                contents.sort(() => Math.random() - 0.5);
                
                pieces.forEach((piece, i) => {
                    piece.innerHTML = contents[i].html;
                    piece.dataset.index = contents[i].index;
                });
                
                this.playSound('click');
            },

            // Tracing Game
            initTracingGame() {
                const canvas = document.getElementById('tracing-canvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;

                let isDrawing = false;
                let lastX = 0;
                let lastY = 0;

                ctx.strokeStyle = '#7C3AED';
                ctx.lineWidth = 5;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                const startDrawing = (e) => {
                    isDrawing = true;
                    const rect = canvas.getBoundingClientRect();
                    lastX = e.clientX - rect.left;
                    lastY = e.clientY - rect.top;
                    this.playSound('click');
                };

                const draw = (e) => {
                    if (!isDrawing) return;
                    
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;

                    ctx.beginPath();
                    ctx.moveTo(lastX, lastY);
                    ctx.lineTo(x, y);
                    ctx.stroke();

                    lastX = x;
                    lastY = y;
                };

                const stopDrawing = () => {
                    isDrawing = false;
                };

                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);

                canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousedown', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    canvas.dispatchEvent(mouseEvent);
                });

                canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousemove', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    canvas.dispatchEvent(mouseEvent);
                });

                canvas.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    const mouseEvent = new MouseEvent('mouseup', {});
                    canvas.dispatchEvent(mouseEvent);
                });
            },

            clearTracing() {
                const canvas = document.getElementById('tracing-canvas');
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                this.playSound('click');
            },

            nextTracingCharacter() {
                const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                const current = document.getElementById('tracing-character').textContent;
                const currentIndex = characters.indexOf(current);
                const nextIndex = (currentIndex + 1) % characters.length;
                
                document.getElementById('tracing-character').textContent = characters[nextIndex];
                this.clearTracing();
                this.playSound('click');
            },

            checkTracing() {
                this.addPoints(25);
                this.showAchievement('Great Tracing!', 'Keep practicing your letters!');
                this.nextTracingCharacter();
            },

            // Math Game
            initMathGame() {
                this.gameData.math = {
                    score: 0,
                    level: 1,
                    streak: 0,
                    currentProblem: null
                };
                
                this.generateMathProblem();
            },

            generateMathProblem() {
                const level = this.gameData.math.level;
                let a, b, operation, answer, options;

                if (level <= 2) {
                    // Simple addition
                    a = Math.floor(Math.random() * 10) + 1;
                    b = Math.floor(Math.random() * 10) + 1;
                    operation = '+';
                    answer = a + b;
                } else if (level <= 4) {
                    // Addition and subtraction
                    a = Math.floor(Math.random() * 20) + 1;
                    b = Math.floor(Math.random() * 20) + 1;
                    operation = Math.random() > 0.5 ? '+' : '-';
                    answer = operation === '+' ? a + b : a - b;
                } else {
                    // Multiplication
                    a = Math.floor(Math.random() * 12) + 1;
                    b = Math.floor(Math.random() * 12) + 1;
                    operation = '√ó';
                    answer = a * b;
                }

                // Generate options
                options = [answer];
                while (options.length < 4) {
                    const wrong = answer + Math.floor(Math.random() * 10) - 5;
                    if (!options.includes(wrong) && wrong > 0) {
                        options.push(wrong);
                    }
                }
                options.sort(() => Math.random() - 0.5);

                this.gameData.math.currentProblem = { a, b, operation, answer };
                
                document.getElementById('math-problem').textContent = `${a} ${operation} ${b} = ?`;
                
                const optionsContainer = document.getElementById('math-options');
                optionsContainer.innerHTML = options.map(option => `
                    <button onclick="app.checkMathAnswer(${option})" class="btn-native text-2xl font-bold">
                        ${option}
                    </button>
                `).join('');
            },

            checkMathAnswer(selected) {
                const correct = this.gameData.math.currentProblem.answer;
                const feedback = document.getElementById('math-feedback');
                
                if (selected === correct) {
                    this.gameData.math.score += 10;
                    this.gameData.math.streak++;
                    feedback.textContent = 'Correct! üéâ';
                    feedback.className = 'text-center text-lg font-semibold mb-4 text-green-600';
                    this.playSound('success');
                    this.createParticles('star');
                    
                    // Level up every 5 correct answers
                    if (this.gameData.math.score % 50 === 0) {
                        this.gameData.math.level++;
                        this.showAchievement('Level Up!', `You reached level ${this.gameData.math.level}!`);
                    }
                } else {
                    this.gameData.math.streak = 0;
                    feedback.textContent = `Not quite! The answer was ${correct}`;
                    feedback.className = 'text-center text-lg font-semibold mb-4 text-red-600';
                    this.playSound('error');
                }
                
                document.getElementById('math-score').textContent = this.gameData.math.score;
                document.getElementById('math-level').textContent = this.gameData.math.level;
                document.getElementById('math-streak').textContent = this.gameData.math.streak;
                
                setTimeout(() => this.generateMathProblem(), 2000);
            },

            skipMathProblem() {
                this.generateMathProblem();
                this.playSound('click');
            },

            showMathHint() {
                const { a, b, operation } = this.gameData.math.currentProblem;
                let hint = '';
                
                if (operation === '+') {
                    hint = `Try counting up from ${a} by ${b}!`;
                } else if (operation === '-') {
                    hint = `Try counting down from ${a} by ${b}!`;
                } else {
                    hint = `Think of ${a} groups of ${b}!`;
                }
                
                document.getElementById('math-feedback').textContent = `üí° ${hint}`;
                document.getElementById('math-feedback').className = 'text-center text-lg font-semibold mb-4 text-blue-600';
                this.playSound('click');
            },

            // Utility functions
            addPoints(points) {
                this.state.user.points += points;
                this.state.user.totalPoints += points;
                this.updateUI();
                this.saveState();
                this.createParticles('star');
            },

            showAchievement(title, message) {
                const popup = document.createElement('div');
                popup.className = 'achievement-popup';
                popup.innerHTML = `
                    <i class="fas fa-trophy text-2xl"></i>
                    <div>
                        <div class="font-bold">${title}</div>
                        <div class="text-sm">${message}</div>
                    </div>
                `;
                document.body.appendChild(popup);
                
                this.playSound('levelup');
                
                setTimeout(() => {
                    popup.style.animation = 'slideOut 0.5s ease-out forwards';
                    setTimeout(() => popup.remove(), 500);
                }, 3000);
            },

            createParticles(type) {
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        const particle = document.createElement('div');
                        particle.className = `particle ${type}`;
                        particle.style.left = Math.random() * window.innerWidth + 'px';
                        particle.style.top = Math.random() * window.innerHeight + 'px';
                        document.body.appendChild(particle);
                        
                        setTimeout(() => particle.remove(), 2000);
                    }, i * 50);
                }
            },

            playSound(type) {
                const sound = document.getElementById(`sound-${type}`);
                if (sound) {
                    sound.currentTime = 0;
                    sound.play().catch(e => console.log('Sound play failed:', e));
                }
            },

            changeAvatar(avatar) {
                this.state.user.avatar = avatar;
                this.updateUI();
                this.saveState();
                this.playSound('click');
                this.createParticles('star');
            },

            checkDailyStreak() {
                const lastVisit = localStorage.getItem('athena-last-visit');
                const today = new Date().toDateString();
                
                if (lastVisit !== today) {
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (lastVisit === yesterday.toDateString()) {
                        this.state.user.streak++;
                    } else {
                        this.state.user.streak = 1;
                    }
                    
                    localStorage.setItem('athena-last-visit', today);
                    this.saveState();
                }
            },

            showDailyChallenge() {
                this.switchTab('games');
            },

            showAgeSelector() {
                // Implementation for age selector
                this.toggleDrawer();
            },

            showAchievements() {
                // Implementation for achievements
                this.toggleDrawer();
            },

            showSettings() {
                // Implementation for settings
                this.toggleDrawer();
            },

            showParents() {
                // Implementation for parents area
                this.toggleDrawer();
            },

            setupEventListeners() {
                // Setup global event listeners
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeGame();
                    }
                });

                // Prevent zoom on double tap
                let lastTouchEnd = 0;
                document.addEventListener('touchend', (e) => {
                    const now = Date.now();
                    if (now - lastTouchEnd <= 300) {
                        e.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            },

            startAnimations() {
                // Start continuous animations
                setInterval(() => {
                    if (Math.random() > 0.8) {
                        this.createParticles('sparkle');
                    }
                }, 5000);
            }
        };

        // Initialize app when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => app.init());
        } else {
            app.init();
        }

        // Service Worker for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZnVuY3Rpb24oZXZlbnQpIHsKICBldmVudC53YWl0VW50aWwoCiAgICBjYWNoZXMub3BlbignYXRoZW5hLXYxJykudGhlbihmdW5jdGlvbihjYWNoZSkgewogICAgICByZXR1cm4gY2FjaGUuYWRkQWxsKFsnLyddKTsKICAgIH0pCiAgKTsKfSk7CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZnVuY3Rpb24oZXZlbnQpIHsKICBldmVudC5yZXNwb25kV2l0aCgKICAgIGNhY2hlcy5tYXRjaChldmVudC5yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgIHJldHVybiByZXNwb25zZSB8fCBmZXRjaChldmVudC5yZXF1ZXN0KTsKICAgIH0pCiAgKTsKfSk7')
                .catch(err => console.log('SW registration failed'));
        }

        // Install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button after 5 seconds
            setTimeout(() => {
                const installBtn = document.createElement('div');
                installBtn.className = 'fixed bottom-24 right-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-full shadow-lg z-50 cursor-pointer';
                installBtn.innerHTML = '<i class="fas fa-download mr-2"></i>Install App';
                installBtn.onclick = () => {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            installBtn.remove();
                        }
                        deferredPrompt = null;
                    });
                };
                document.body.appendChild(installBtn);
            }, 5000);
        });
    </script>
</body>
</html>
